{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport * as FS from 'expo-file-system';\nimport Alarm from \"../Lib/Alarm\";\n\nvar AlarmContainer = function () {\n  function AlarmContainer() {\n    _classCallCheck(this, AlarmContainer);\n\n    this.alarmsList = [];\n  }\n\n  _createClass(AlarmContainer, [{\n    key: \"Add\",\n    value: function Add(_ref) {\n      var alarm = _ref.alarm;\n      var id = this.alarmsList.length;\n      this.alarmsList.push(alarm);\n      this.SaveToJson();\n      return id;\n    }\n  }, {\n    key: \"Remove\",\n    value: function Remove(_ref2) {\n      var id = _ref2.id;\n      var alarm = this.GetByAdd({\n        id: id\n      });\n\n      if (alarm.isActive()) {\n        alarm.deactivate();\n      }\n\n      this.alarmsList.splice(id, 1);\n      this.SaveToJson();\n    }\n  }, {\n    key: \"GetAll\",\n    value: function GetAll() {\n      return this.alarmsList;\n    }\n  }, {\n    key: \"Count\",\n    value: function Count() {\n      return this.alarmsList.length;\n    }\n  }, {\n    key: \"GetByAdd\",\n    value: function GetByAdd(_ref3) {\n      var id = _ref3.id;\n      return this.alarmsList[id];\n    }\n  }, {\n    key: \"SaveToJson\",\n    value: function SaveToJson() {\n      var jsonData, saveFilePath;\n      return _regeneratorRuntime.async(function SaveToJson$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              jsonData = JSON.stringify(this.alarmsList);\n              saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(FS.writeAsStringAsync(saveFilePath, jsonData));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"Load\",\n    value: function Load(_ref4) {\n      var _this = this;\n\n      var onLoadedCb, saveFilePath;\n      return _regeneratorRuntime.async(function Load$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              onLoadedCb = _ref4.onLoadedCb;\n              saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n              this.alarmsList = [];\n              FS.readAsStringAsync(saveFilePath).then(function (jsonData) {\n                alarmJsonArray = JSON.parse(jsonData);\n                alarmJsonArray.map(function (alarmJson) {\n                  _this.alarmsList.push(Alarm.ConstructFromJson({\n                    jsonObject: alarmJson\n                  }));\n                });\n                onLoadedCb(true);\n              }).catch(function (err) {\n                _this.alarmsList = [];\n                onLoadedCb(false);\n              });\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }]);\n\n  return AlarmContainer;\n}();\n\nAlarmContainer.saveFileName = \"alarms.json\";\nAlarmContainer.instance = AlarmContainer.instance || new AlarmContainer();\nexport default AlarmContainer;","map":{"version":3,"sources":["C:/Users/vladi/source/repos/SimpleAlarmClockApp/Lib/AlarmManager.js"],"names":["FS","Alarm","AlarmContainer","alarmsList","alarm","id","length","push","SaveToJson","GetByAdd","isActive","deactivate","splice","jsonData","JSON","stringify","saveFilePath","documentDirectory","saveFileName","writeAsStringAsync","onLoadedCb","readAsStringAsync","then","alarmJsonArray","parse","map","alarmJson","ConstructFromJson","jsonObject","catch","err","instance"],"mappings":";;;AAAA,OAAO,KAAKA,EAAZ,MAAoB,kBAApB;AAEA,OAAOC,KAAP;;IAEMC,c;;;;SAyDFC,U,GAAa,E;;;;;WArDb,mBAAe;AAAA,UAATC,KAAS,QAATA,KAAS;AACX,UAAMC,EAAE,GAAG,KAAKF,UAAL,CAAgBG,MAA3B;AACA,WAAKH,UAAL,CAAgBI,IAAhB,CAAqBH,KAArB;AACA,WAAKI,UAAL;AACA,aAAOH,EAAP;AACH;;;WAED,uBAAe;AAAA,UAANA,EAAM,SAANA,EAAM;AACX,UAAMD,KAAK,GAAG,KAAKK,QAAL,CAAc;AAAEJ,QAAAA,EAAE,EAAEA;AAAN,OAAd,CAAd;;AACA,UAAID,KAAK,CAACM,QAAN,EAAJ,EAAsB;AAClBN,QAAAA,KAAK,CAACO,UAAN;AACH;;AACD,WAAKR,UAAL,CAAgBS,MAAhB,CAAuBP,EAAvB,EAA2B,CAA3B;AACA,WAAKG,UAAL;AACH;;;WAED,kBAAS;AACL,aAAO,KAAKL,UAAZ;AACH;;;WAED,iBAAQ;AACJ,aAAO,KAAKA,UAAL,CAAgBG,MAAvB;AACH;;;WAED,yBAAiB;AAAA,UAAND,EAAM,SAANA,EAAM;AACb,aAAO,KAAKF,UAAL,CAAgBE,EAAhB,CAAP;AACH;;;WAED;AAAA;AAAA;AAAA;AAAA;AAAA;AACUQ,cAAAA,QADV,GACqBC,IAAI,CAACC,SAAL,CAAe,KAAKZ,UAApB,CADrB;AAEUa,cAAAA,YAFV,GAEyBhB,EAAE,CAACiB,iBAAH,GAAuB,GAAvB,GAA6B,KAAKC,YAF3D;AAAA;AAAA,+CAIUlB,EAAE,CAACmB,kBAAH,CAAsBH,YAAtB,EAAoCH,QAApC,CAJV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;WAOA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAaO,cAAAA,UAAb,SAAaA,UAAb;AACUJ,cAAAA,YADV,GACyBhB,EAAE,CAACiB,iBAAH,GAAuB,GAAvB,GAA6B,KAAKC,YAD3D;AAEI,mBAAKf,UAAL,GAAkB,EAAlB;AAEAH,cAAAA,EAAE,CAACqB,iBAAH,CAAqBL,YAArB,EACKM,IADL,CACU,UAACT,QAAD,EAAc;AAChBU,gBAAAA,cAAc,GAAGT,IAAI,CAACU,KAAL,CAAWX,QAAX,CAAjB;AACAU,gBAAAA,cAAc,CAACE,GAAf,CAAmB,UAACC,SAAD,EAAe;AAC9B,kBAAA,KAAI,CAACvB,UAAL,CAAgBI,IAAhB,CAAqBN,KAAK,CAAC0B,iBAAN,CAAwB;AAAEC,oBAAAA,UAAU,EAAEF;AAAd,mBAAxB,CAArB;AACH,iBAFD;AAGAN,gBAAAA,UAAU,CAAC,IAAD,CAAV;AACH,eAPL,EAQKS,KARL,CAQW,UAACC,GAAD,EAAS;AACZ,gBAAA,KAAI,CAAC3B,UAAL,GAAkB,EAAlB;AACAiB,gBAAAA,UAAU,CAAC,KAAD,CAAV;AACH,eAXL;;AAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;AAvCElB,c,CAEKgB,Y,GAAe,a;AAFpBhB,c,CAGK6B,Q,GAAW7B,cAAc,CAAC6B,QAAf,IAA2B,IAAI7B,cAAJ,E;AAyDjD,eAAeA,cAAf","sourcesContent":["import * as FS from 'expo-file-system';\n\nimport Alarm from '../Lib/Alarm';\n\nclass AlarmContainer {\n\n    static saveFileName = \"alarms.json\";\n    static instance = AlarmContainer.instance || new AlarmContainer();\n    Add({ alarm }) {\n        const id = this.alarmsList.length;\n        this.alarmsList.push(alarm);\n        this.SaveToJson();\n        return id;\n    }\n\n    Remove({ id }) {\n        const alarm = this.GetByAdd({ id: id });\n        if (alarm.isActive()) {\n            alarm.deactivate();\n        }\n        this.alarmsList.splice(id, 1);\n        this.SaveToJson();\n    }\n\n    GetAll() {\n        return this.alarmsList;\n    }\n\n    Count() {\n        return this.alarmsList.length;\n    }\n\n    GetByAdd({ id }) {\n        return this.alarmsList[id];\n    }\n\n    async SaveToJson() {\n        const jsonData = JSON.stringify(this.alarmsList);\n        const saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n\n        await FS.writeAsStringAsync(saveFilePath, jsonData);\n    }\n\n    async Load({ onLoadedCb }) {\n        const saveFilePath = FS.documentDirectory + '/' + this.saveFileName;\n        this.alarmsList = [];\n\n        FS.readAsStringAsync(saveFilePath)\n            .then((jsonData) => {\n                alarmJsonArray = JSON.parse(jsonData);\n                alarmJsonArray.map((alarmJson) => {\n                    this.alarmsList.push(Alarm.ConstructFromJson({ jsonObject: alarmJson }));\n                });\n                onLoadedCb(true);\n            })\n            .catch((err) => {\n                this.alarmsList = [];\n                onLoadedCb(false);\n            });\n    }\n\n    alarmsList = [];\n}\n\nexport default AlarmContainer;\n"]},"metadata":{},"sourceType":"module"}